# Rustの汎用トレイとに関するメモ

## `T: ?Sized`

`T: Sized`制約は自動的につけられる

それを明示的に解除するために`T: ?Sized`をつける。

これによって、サイズ不定型が使えるようになる。(たとえば `dyn`, `str`, `[T]`など)

## `RefCell`, `Cell`

このラッパ型は内部可変性を提供するもの。
RefCellとCellの違いは、CellはCopy型だけのためのものであり、RefCellにはその制約は無いということです。

このラッパ型を用いることでこのようなコードでもコンパイルすることができます。

y,zはxのイミュータブル参照ですが、同じ値を変更することができています。

```rust
use std::cell::Cell;

let x = Cell::new(1);
let y = &x;
let z = &x;
x.set(2);
y.set(3);
z.set(9);
println!("{}", x.get());
```

動作コストとしてはこのコードと変わりませんが、`Cell`の使用により借用規則の適用を実行時まで先延ばしにしています。

以下のコードは借用規則のチェックをコンパイル事に行っているのでコンパイルできません。

```rust
let mut x = 1;
let y = &mut x;
let z = &mut x;
x = 2;
*y = 3;
*z = 4;
println!("{}", x);
```

Rustのコンパイラは保守的なので、メモリ安全でない**可能性のある**コードはコンパイルできません。そのようなときのために`Cell`などのラッパ型が提供されています。

## `Defef`

`*`演算子をオーバーフローづするためのトレイト。以上!!
